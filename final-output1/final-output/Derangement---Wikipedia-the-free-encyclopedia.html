<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Derangement---Wikipedia-the-free-encyclopedia.html</title></head>
<body>
<h1>Derangement</h1>
<p>In combinatorial mathematics, a <b>derangement</b> is a permutation of the elements of a set such that none of the elements appear in their original position.</p>
<p>The number of derangements of a set of size <i>n</i>, usually written <i>D<sub>n</sub></i>, <i>d<sub>n</sub></i>, or !<i>n</i>, is called the "derangement number" or "de Montmort number". (These numbers are generalized to rencontres numbers.) The <b>subfactorial</b> function (not to be confused with the factorial <i>n</i>!) maps <i>n</i> to !<i>n</i>. No standard notation for subfactorials is agreed upon; <i>n</i>¡ is sometimes used instead of !<i>n</i>.</p>
<p>The problem of counting derangements was first considered by Pierre Raymond de Montmort in 1708; he solved it in 1713, as did Nicholas Bernoulli at about the same time.</p>
<p></p>
<h2>Contents</h2>
<ul>
<li>1 Example</li>
<li>2 Counting derangements</li>
<li>3 Limit of ratio of derangement to permutation as <i>n</i> approaches ∞</li>
<li>4 Generalizations</li>
<li>5 Computational complexity</li>
<li>6 References</li>
<li>7 External links</li>
</ul>
<p></p>
<h2>Example</h2>
<p>Suppose that a professor has had 4 of his students – student A, student B, student C, and student D - take a test and wants to let his students grade each other's tests. Of course, no student should grade his or her own test. How many ways could the professor hand the tests back to the students for grading, such that no student received his or her own test back? Out of 24 possible permutations (4!) for handing back the tests, there are only 9 derangements:</p>
<p>In every other permutation of this 4-member set, at least one student gets his or her own test back.</p>
<p>Another version of the problem arises when we ask for the number of ways <i>n</i> letters, each addressed to a different person, can be placed in <i>n</i> pre-addressed envelopes so that no letter appears in the correctly addressed envelope.</p>
<h2>Counting derangements</h2>
<p>Suppose that there are <i>n</i> persons numbered 1, 2, ..., <i>n</i>. Let there be <i>n</i> hats also numbered 1, 2, ..., <i>n</i>. We have to find the number of ways in which no one gets the hat having same number as his/her number. Let us assume that the first person takes hat <i>i</i>. There are <i>n</i> − 1 ways for the first person to make such a choice. There are now two possibilities, depending on whether or not person <i>i</i> takes hat 1 in return:</p>
<ol>
<li>Person <i>i</i> does not take the hat 1. This case is equivalent to solving the problem with <i>n</i> − 1 persons and <i>n</i> − 1 hats: each of the remaining <i>n</i> − 1 people has precisely 1 forbidden choice from among the remaining <i>n</i> − 1 hats (<i>i'</i>s forbidden choice is hat 1).</li>
<li>Person <i>i</i> takes the hat 1. Now the problem reduces to <i>n</i> − 2 persons and <i>n</i> − 2 hats.</li>
</ol>
<p>From this, the following relation is derived:</p>
<p>where !n, known as the subfactorial, represents the number of derangements, with the starting values !0 = 1 and !1 = 0.</p>
<p>Notice that this same recurrence formula also works for factorials with different starting values. That is 0! = 1, 1! = 1 and</p>
<p>which is helpful in proving the limit relationship with <i>e</i> below.</p>
<p>Also, the following formulae are known:</p>
<p>where [<i>x</i>] is the nearest integer function.</p>
<p>where <img class="mwe-math-fallback-image-inline tex" alt="\left\lfloor x \right\rfloor" src="//upload.wikimedia.org/math/6/3/d/63d3bf2afa6f62b428c1036032eaa152.png"> is the floor function. The following recurrence relationship also holds:</p>
<p>Starting with <i>n</i> = 0, the numbers of derangements of <i>n</i> are:</p>
<p>These numbers are also called <b>subfactorial</b> or <b>rencontres numbers</b>.</p>
<p>Perhaps a more well-known method of counting derangements uses the inclusion-exclusion principle.</p>
<h2>Limit of ratio of derangement to permutation as <i>n</i> approaches ∞</h2>
<p>Using this recurrence, it can be shown that, in the limit,</p>
<p>This is the limit of the probability <i>p</i><sub><i>n</i></sub> = <i>d</i><sub><i>n</i></sub>/<i>n</i>! that a randomly selected permutation is a derangement. The probability converges to this limit extremely quickly as <i>n</i> increases, which is why <i>d</i><sub><i>n</i></sub> is the nearest integer to <i>n</i>!/<i>e</i>. The above semi-log graph shows that the derangement graph lags the permutation graph by an almost constant value.</p>
<p>More information about this calculation and the above limit may be found in the article on the statistics of random permutations.</p>
<h2>Generalizations</h2>
<p>The problème des rencontres asks how many permutations of a size-<i>n</i> set have exactly <i>k</i> fixed points.</p>
<p>Derangements are an example of the wider field of constrained permutations. For example, the <i>ménage problem</i> asks if <i>n</i> opposite-sex couples are seated man-woman-man-woman-... around a circular table, how many ways can they be seated so that nobody is seated next to his or her partner?</p>
<p>More formally, given sets <i>A</i> and <i>S</i>, and some sets <i>U</i> and <i>V</i> of surjections <i>A</i> → <i>S</i>, we often wish to know the number of pairs of functions (<i>f</i>, <i>g</i>) such that <i>f</i> is in <i>U</i> and <i>g</i> is in <i>V</i>, and for all <i>a</i> in <i>A</i>, <i>f</i>(<i>a</i>) ≠ <i>g</i>(<i>a</i>); in other words, where for each <i>f</i> and <i>g</i>, there exists a derangement φ of <i>S</i> such that <i>f</i>(<i>a</i>) = φ(<i>g</i>(<i>a</i>)).</p>
<p>Another generalization is the following problem:</p>
<p>For instance, for a word made of only two different letters, say <i>n</i> letters A and <i>m</i> letters B, the answer is, of course, 1 or 0 according whether <i>n</i> = <i>m</i> or not, for the only way to form an anagram without fixed letters is to exchange all the <i>A</i> with <i>B</i>, which is possible if and only if <i>n</i> = <i>m</i>. In the general case, for a word with <i>n</i><sub>1</sub> letters <i>X</i><sub>1</sub>, <i>n</i><sub>2</sub> letters <i>X</i><sub>2</sub>, ..., <i>n</i><sub><i>r</i></sub> letters <i>X</i><sub><i>r</i></sub> it turns out (after a proper use of the inclusion-exclusion formula) that the answer has the form:</p>
<p>for a certain sequence of polynomials <i>P</i><sub><i>n</i></sub>, where <i>P</i><sub><i>n</i></sub> has degree <i>n</i>. But the above answer for the case <i>r</i> = 2 gives an orthogonality relation, whence the <i>P</i><sub><i>n</i></sub>'s are the Laguerre polynomials (up to a sign that is easily decided).</p>
<h2>Computational complexity</h2>
<p>It is NP-complete to determine whether a given permutation group (described by a given set of permutations that generate it) contains any derangements.</p>
</body>
</html>