<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Chinese-remainder-theorem---Wikipedia-the-free-encyclopedia.html</title></head>
<body>
<h1>Chinese remainder theorem</h1>
<p>The <b>Chinese remainder theorem</b> is a result about congruences in number theory and its generalizations in abstract algebra. It was first published in the 3rd to 5th centuries by Chinese mathematician Sun Tzu.</p>
<p>In its basic form, the Chinese remainder theorem will determine a number <i>n</i> that when divided by some given divisors leaves given remainders. For example, what is the lowest number <i>n</i> that when divided by 3 leaves a remainder of 2, when divided by 5 leaves a remainder of 3, and when divided by 7 leaves a remainder of 2?</p>
<p></p>
<h2>Contents</h2>
<ul>
<li>1 Theorem statement</li>
<li>2 Existence and uniqueness
<ul>
<li>2.1 Case of two equations (<i>k</i> = 2)</li>
<li>2.2 General case</li>
</ul>
</li>
<li>3 Finding the solution with basic algebra and modular arithmetic
<ul>
<li>3.1 Brute-force Approach</li>
<li>3.2 Algebraic Approach</li>
</ul>
</li>
<li>4 A constructive algorithm to find the solution</li>
<li>5 Statement for principal ideal domains</li>
<li>6 Statement for general rings</li>
<li>7 Applications
<ul>
<li>7.1 Sequence Numbering</li>
<li>7.2 Fast Fourier Transform</li>
<li>7.3 RSA Algorithm</li>
<li>7.4 Encryption</li>
<li>7.5 Hermite Interpolation</li>
<li>7.6 Dedekind's Theorem</li>
</ul>
</li>
<li>8 Non-commutative case: a caveat</li>
<li>9 See also</li>
<li>10 References</li>
<li>11 External links</li>
</ul>
<ul>
<li>2.1 Case of two equations (<i>k</i> = 2)</li>
<li>2.2 General case</li>
</ul>
<ul>
<li>3.1 Brute-force Approach</li>
<li>3.2 Algebraic Approach</li>
</ul>
<ul>
<li>7.1 Sequence Numbering</li>
<li>7.2 Fast Fourier Transform</li>
<li>7.3 RSA Algorithm</li>
<li>7.4 Encryption</li>
<li>7.5 Hermite Interpolation</li>
<li>7.6 Dedekind's Theorem</li>
</ul>
<p></p>
<h2>Theorem statement</h2>
<p>The original form of the theorem, contained in the 5th-century book <i>Sunzi's Mathematical Classic</i> (孫子算經) by the Chinese mathematician Sun Tzu and later generalized with a complete solution called <i>Dayanshu</i> (大衍術) in Qin Jiushao's 1247 <i>Mathematical Treatise in Nine Sections</i> (數書九章, <i>Shushu Jiuzhang</i>), is a statement about simultaneous congruences.</p>
<p>Suppose <i>n</i><sub>1</sub>, ..., <i>n<sub>k</sub></i> are positive integers that are pairwise coprime. Then, for any given sequence of integers <i>a</i><sub>1</sub>, ..., <i>a<sub>k</sub></i>, there exists an integer x solving the following system of simultaneous congruences.</p>
<p>Furthermore, all solutions x of this system are congruent modulo the product, <i>N</i> = <i>n</i><sub>1</sub> ... <i>n<sub>k</sub></i>. Hence</p>
<p>Sometimes, the simultaneous congruences can be solved even if the <i>n<sub>i</sub></i> are not pairwise coprime. A solution x exists if and only if:</p>
<p>All solutions x are then congruent modulo the least common multiple of the <i>n<sub>i</sub></i>.</p>
<p>Sun Tzu's work contains neither a proof nor a full algorithm. What amounts to an algorithm for solving this problem was described by Aryabhata (6th century; see Kak 1986). Special cases of the Chinese remainder theorem were also known to Brahmagupta (7th century), and appear in Fibonacci's Liber Abaci (1202).</p>
<p>A modern restatement of the theorem in algebraic language is that for a positive integer with prime factorization</p>
<p>we have the isomorphism between a ring and the direct product of its prime power parts:</p>
<p>The theorem can also be restated in the language of combinatorics as the fact that the infinite arithmetic progressions of integers form a Helly family (Duchet 1995).</p>
<h2>Existence and uniqueness</h2>
<p>The existence and uniqueness of the solution can easily be seen through a non-constructive argument:</p>
<p>There are <i>N</i> = <i>n</i><sub>1</sub> ... <i>n<sub>k</sub></i> different k-tuples of remainders. Let us call this set R. On the other hand <i>N</i> = #{1, ..., <i>N</i>}, and each element of {1, ..., <i>N</i>} corresponds to an element of R. Can two numbers <i>a</i>, <i>b</i> ∈ {1, ..., <i>N</i>}, correspond to the same member of R? That is, can they have the same set of remainders when divided by <i>n</i><sub>1</sub>, ..., <i>n<sub>k</sub></i>? If they did then <i>a</i> − <i>b</i> would be divisible by each n<sub>i</sub>. Since the n<sub>i</sub> are relatively prime, <i>a</i> − <i>b</i> would be divisible by their product: N. This can't be, so this function {1, ..., <i>N</i>} → <i>R</i> is one-to-one. Since #{1, ..., <i>N</i>} = #<i>R</i>, it must be onto as well. Thus we have established the existence of a bijection.</p>
<p>Existence can be seen by an explicit construction of x. Let [<i>a</i>]<sub><i>b</i></sub> denote the multiplicative inverse of <i>a</i> (mod <i>b</i>) given by the Extended Euclidean algorithm. It is defined exactly when a and b are coprime; the following construction explains why this condition is needed.</p>
<h3>Case of two equations (<i>k</i> = 2)</h3>
<p>Consider the system:</p>
<p>Since gcd(<i>n</i><sub>1</sub>, <i>n</i><sub>2</sub>) = 1, Bézout's identity implies:</p>
<p>This is true because we are using the inverses provided by the Extended Euclidean algorithm; for any other inverses, this would not necessarily be true, but still be valid (mod <i>n</i><sub>1</sub><i>n</i><sub>2</sub>).</p>
<p>Multiplying both sides by x, we get</p>
<p>If we take the congruence modulo <i>n</i><sub>1</sub> for the right-hand-side expression, it is readily seen that</p>
<p>But we know that <i>x</i> ≡ <i>a</i><sub>1</sub> (mod <i>n</i><sub>1</sub>), thus this suggests that the coefficient of the first term on the right-hand-side expression can be replaced by <i>a</i><sub>1</sub>. Similarly, we can show that the coefficient of the second term can be substituted by <i>a</i><sub>2</sub>. We can now define the value</p>
<p>and it is seen to satisfy both congruences, for example:</p>
<h3>General case</h3>
<p>The same type of construction works in the general case of k congruence equations. Let <i>N</i> = <i>n</i><sub>1</sub> ... <i>n<sub>k</sub></i> be the product of every modulus then define</p>
<p>and this is seen to satisfy the system of congruences by a similar calculation as before.</p>
<h2>Finding the solution with basic algebra and modular arithmetic</h2>
<p>For example, consider the problem of finding an integer x such that</p>
<h3>Brute-force Approach</h3>
<p>A brute-force approach converts these congruences into sets and writes the elements out to the product of 3×4×5 = 60 (the solutions modulo 60 for each congruence):</p>
<p>To find an x that satisfies all three congruences, intersect the three sets to get:</p>
<p>Which can be expressed as</p>
<h3>Algebraic Approach</h3>
<p>Another way to find a solution is with basic algebra, modular arithmetic, and stepwise substitution.</p>
<p>We start by translating these congruences into equations for some t, s, and u:</p>
<p>Start by substituting the x from the first equation into the second congruence:</p>
<p>meaning that <i>t</i> = 3 + 4<i>s</i> for some integer s. Substitute t into the first equation:</p>
<p>Substitute this x into the third congruence:</p>
<p>meaning that <i>s</i> = 0 + 5<i>u</i> for some integer u. Finally,</p>
<p>So, we have solutions {11, 71, 131, 191, ...}.</p>
<p>Notice that 60 = lcm(3,4,5). If the moduli are pairwise coprime (as they are in this example), the solutions will be congruent modulo their product.</p>
<h2>A constructive algorithm to find the solution</h2>
<p>The following algorithm only applies if the <i>n<sub>i</sub></i> are pairwise coprime. (For simultaneous congruences when the moduli are not pairwise coprime, the method of successive substitution can often yield solutions.)</p>
<p>Suppose, as above, that a solution is required for the system of congruences:</p>
<p>Define: <i>N</i> = <i>n</i><sub>1</sub> ... <i>n<sub>k</sub></i>. For each i, the integers <i>n<sub>i</sub></i> and <i>N</i>/<i>n<sub>i</sub></i> are coprime. Using the extended Euclidean algorithm we can find <i>r<sub>i</sub></i>, <i>s<sub>i</sub></i> ∈ <b>Z</b> such that <i>r<sub>i</sub>n<sub>i</sub></i> + <i>s<sub>i</sub>N</i>/<i>n<sub>i</sub></i> = 1. Substitute <i>e<sub>i</sub></i> for <i>s<sub>i</sub>N</i>/<i>n<sub>i</sub></i>, to arrive at: <i>r<sub>i</sub>n<sub>i</sub></i> + <i>e<sub>i</sub></i> = 1. So the remainder of <i>e<sub>i</sub></i> divided by <i>n<sub>i</sub></i> is 1. On the other hand, <i>e<sub>i</sub></i> = <i>s<sub>i</sub>N</i>/<i>n<sub>i</sub></i>, guarantees that <i>n<sub>j</sub></i> divides <i>e<sub>i</sub></i> for <i>j</i> ≠ <i>i</i>. To summarize:</p>
<p>Because of this, and the multiplication rules allowed in congruences, one solution to the system of simultaneous congruences is:</p>
<p>For example, consider the problem of finding an integer x such that</p>
<p>Using the extended Euclidean algorithm, for x modulo 3 and 20 [4 × 5], we find (−13) × 3 + 2 × 20 = 1; i.e., <i>e</i><sub>1</sub> = 40. For x modulo 4 and 15 [3 × 5], we get (−11) × 4 + 3 × 15 = 1, i.e. <i>e</i><sub>2</sub> = 45. Finally, for x modulo 5 and 12 [3 × 4], we get 5 × 5 + (−2) × 12 = 1, i.e. <i>e</i><sub>3</sub> = −24. A solution x is therefore 2 × 40 + 3 × 45 + 1 × (−24) = 191. All other solutions are congruent to 191 modulo 60, [3 × 4 × 5], which means they are all congruent to 11 modulo 60.</p>
<p>Note: There are multiple implementations of the extended Euclidean algorithm which will yield different sets of <i>e</i><sub>1</sub> = −20, <i>e</i><sub>2</sub> = −15, and <i>e</i><sub>3</sub> = −24. These sets however will produce the same solution; i.e., (−20)2 + (−15)3 + (−24)1 = −109 ≡ 11 (mod 60).</p>
<h2>Statement for principal ideal domains</h2>
<p>This statement is a straightforward generalization of the above theorem about integer congruences: <b>Z</b> is a principal ideal domain, the surjectivity of the map <i>f</i> shows that every system of congruences of the form</p>
<p>can be solved for x, and the injectivity of the map <i>f</i> shows that all the solutions x are congruent modulo u.</p>
<p><b>Proof.</b> This map is well-defined and an isomorphism of rings; the inverse isomorphism can be constructed as follows. For each i, the elements <i>u<sub>i</sub></i> and <i>u/u<sub>i</sub></i> are coprime, and therefore there exist elements r and s in R with</p>
<p>Set <i>e<sub>i</sub></i> = <i>su/u<sub>i</sub></i>. Then it is clear that</p>
<p>Thus the inverse of <i>f</i> is the map</p>
<h2>Statement for general rings</h2>
<p>The general form of the Chinese remainder theorem, which implies all the statements given above, can be formulated for commutative rings and ideals.</p>
<p>Here is a version of the theorem where <i>R</i> is not required to be commutative:</p>
<h2>Applications</h2>
<h3>Sequence Numbering</h3>
<p>The Chinese remainder theorem can be used to construct an elegant Gödel numbering for sequences, which is needed to prove Gödel's incompleteness theorems.</p>
<h3>Fast Fourier Transform</h3>
<p>The Good-Thomas fast Fourier transform algorithm exploits a re-indexing of the data based on the Chinese remainder theorem. The Prime-factor FFT algorithm contains an implementation.</p>
<h3>RSA Algorithm</h3>
<p>In the RSA algorithm calculations are made modulo n, where n is a product of two large prime numbers p and q. 1,024-, 2,048- or 4,096-bit integers n are commonly used, making calculations in <b>Z</b>/<i>n</i><b>Z</b> very time-consuming. By the Chinese remainder theorem, however, these calculations can be done in the isomorphic ring <b>Z</b>/<i>p</i><b>Z</b> ⊕ <b>Z</b>/<i>q</i><b>Z</b> instead. Since p and q are normally of about the same size, that is about √<i>n</i>, calculations in the latter representation are much faster. Note that RSA algorithm implementations using this isomorphism are more susceptible to fault injection attacks.</p>
<h3>Encryption</h3>
<p>The Chinese remainder theorem can also be used in secret sharing, which consists of distributing a set of shares among a group of people who, all together (but no one alone), can recover a certain secret from the given set of shares. Each of the shares is represented in a congruence, and the solution of the system of congruences using the Chinese remainder theorem is the secret to be recovered. Secret Sharing using the Chinese Remainder Theorem uses, along with the Chinese remainder theorem, special sequences of integers that guarantee the impossibility of recovering the secret from a set of shares with less than a certain cardinality.</p>
<h3>Hermite Interpolation</h3>
<p><b>Solution.</b> Introducing the polynomials</p>
<p>the problem may be equivalently reformulated as a system of r simultaneous congruences:</p>
<p>By the Chinese remainder theorem in the principal ideal domain <b>C</b>[<i>x</i>], there is a unique polynomial <i>P</i>(<i>x</i>) such that:</p>
<p>A direct construction, in analogy with the above proof for the integer number case, can be performed as follows. Define the polynomials</p>
<p>The partial fraction decomposition of 1/<i>Q</i> gives r polynomials <i>S<sub>j</sub></i> with degrees deg(<i>S<sub>j</sub></i>) &lt; <i>ν<sub>j</sub></i> such that</p>
<p>so that</p>
<p>Then a solution of the simultaneous congruence system is given by the polynomial</p>
<p>and the minimal degree solution is this one reduced modulo Q, that is the unique with degree less than n.</p>
<h3>Dedekind's Theorem</h3>
<p><b>Proof.</b> First assume that k is a field, otherwise, replace the integral domain k by its quotient field, and nothing will change. We can linearly extend the monoid homomorphisms  <i>f<sub>i</sub></i> : <i>M</i> → <i>k</i> to k-algebra homomorphisms <i>F<sub>i</sub></i> : <i>k</i>[<i>M</i>] → <i>k</i>, where <i>k</i>[<i>M</i>] is the monoid ring of M over k. Then, by linearity, the condition</p>
<p>yields</p>
<p>Next, for <i>i</i>, <i>j</i> ∈ <i>I</i>; <i>i</i> ≠ <i>j</i> the two k-linear maps <i>F<sub>i</sub></i> : <i>k</i>[<i>M</i>] → <i>k</i> and <i>F<sub>j</sub></i> : <i>k</i>[<i>M</i>] → <i>k</i> are not proportional to each other. Otherwise  <i>f<sub>i</sub></i>  and  <i>f<sub>j</sub></i>  would also be proportional, and thus equal since as monoid homomorphisms they satisfy:  <i>f<sub>i</sub></i> (1) = 1 =  <i>f<sub>j</sub></i> (1), which contradicts the assumption that they are distinct.</p>
<p>Therefore the kernels Ker <i>F<sub>i</sub></i> and Ker <i>F<sub>j</sub></i> are distinct. Since <i>k</i>[<i>M</i>]/Ker <i>F<sub>i</sub></i> ≅ <i>F<sub>i</sub></i>(<i>k</i>[<i>M</i>]) = <i>k</i> is a field, Ker <i>F<sub>i</sub></i> is a maximal ideal of <i>k</i>[<i>M</i>] for every <i>i</i> ∈ <i>I</i>. Because they are distinct and maximal the ideals Ker <i>F<sub>i</sub></i> and Ker <i>F<sub>j</sub></i> are coprime whenever <i>i</i> ≠ <i>j</i>. The Chinese Remainder Theorem (for general rings) yields an isomorphism:</p>
<p>where</p>
<p>Consequently, the map</p>
<p>is surjective. Under the isomorphisms <i>k</i>[<i>M</i>]/Ker <i>F<sub>i</sub></i> → <i>F<sub>i</sub></i>(<i>k</i>[<i>M</i>]) = <i>k</i>, the map Φ corresponds to:</p>
<p>Now,</p>
<p>yields</p>
<p>for every vector (<i>u<sub>i</sub></i>)<sub><i>i</i>∈<i>I</i></sub> in the image of the map ψ. Since ψ is surjective, this means that</p>
<p>for every vector</p>
<p>Consequently, (<i>α<sub>i</sub></i>)<sub><i>i</i>∈<i>I</i></sub> = (0)<sub><i>i</i>∈<i>I</i></sub>. QED.</p>
<h2>Non-commutative case: a caveat</h2>
<p>Sometimes in the commutative case, the conclusion of the Chinese Remainder Theorem is stated as <i>R</i>/(<i>I</i><sub>1</sub> ... <i>I<sub>k</sub></i>) ≅ <i>R</i>/<i>I</i><sub>1</sub> × ... × <i>R</i>/<i>I<sub>k</sub></i>. This version does not hold in the non-commutative case, since <i>I</i><sub>1</sub> ∩ ... ∩ <i>I<sub>k</sub></i> ≠ <i>I</i><sub>1</sub> ... <i>I<sub>k</sub></i>, as can be seen from the following case:</p>
<p><b>Proof.</b> Observe that I is formed by all polynomials with an x in every term and that every polynomial in J vanishes under the substitution <i>y</i> = − 1/<i>x</i>. Then clearly <i>p</i> = (<i>xy</i> + 1)<i>x</i> ∈ <i>I</i> ∩ <i>J</i>. Define a "term in R", as an element of the multiplicative monoid of R generated by x and y, and its degree as the usual degree of the term after the substitution <i>y</i> = <i>x</i>. On the other hand, suppose <i>q</i> ∈ <i>J</i>. Observe that a term in q of maximum degree depends on y otherwise q under the substitution <i>y</i> = − 1/<i>x</i> can not vanish. The same happens then for an element <i>q</i> ∈ <i>IJ</i>. Note that the last y, from left to right, in a term of maximum degree in an element of IJ is preceded by more than one x. (We are counting here all the preceding xs. E.g., in <i>x</i><i>yxyx</i> the last y is preceded by three xs.) This proves that <i>p</i> = (<i>xy</i> + 1)<i>x</i> ∉ <i>IJ</i> since the last y in the term of maximum degree in p (xyx) is preceded by only one x. Hence <i>I</i> ∩ <i>J</i> ≠ <i>IJ</i>.</p>
<p>However, it is true in general that <i>I</i> + <i>J</i> = <i>R</i> implies <i>I</i> ∩ <i>J</i> = <i>IJ</i> + <i>JI</i>. To see this, note that <i>I</i> ∩ <i>J</i> = (<i>I</i> ∩ <i>J</i>)(<i>I</i> + <i>J</i>) ⊂ <i>IJ</i> + <i>JI</i>, while the opposite inclusion is obvious. Also, we have in general that, provided <i>I</i><sub>1</sub>, ..., <i>I<sub>m</sub></i> are pairwise coprime two-sided ideals in R, the natural map</p>
<p>is an isomorphism. Note that <i>I</i><sub>1</sub> ∩ ... ∩ <i>I<sub>m</sub></i> can be replaced by a sum over all orderings of <i>I</i><sub>1</sub>, ..., <i>I<sub>m</sub></i> of their product (or just a sum over enough orderings, using inductively that <i>I</i> ∩ <i>J</i> = <i>IJ</i> + <i>JI</i> for coprime ideals <i>I</i>, <i>J</i> ⊂ <i>R</i>).</p>
<h2>See also</h2>
<ul>
<li>Covering system</li>
<li>Hasse principle</li>
<li>Residue number system</li>
<li>Secret sharing using the Chinese remainder theorem</li>
</ul>
</body>
</html>