<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Christofides-algorithm---Wikipedia-the-free-encyclopedia.html</title></head>
<body>
<h1>Christofides algorithm</h1>
<p>The goal of the <b>Christofides approximation algorithm</b> (named after Nicos Christofides) is to find a solution to the instances of the traveling salesman problem where the edge weights satisfy the triangle inequality. Let <img class="mwe-math-fallback-image-inline tex" alt="G=(V,w)" src="//upload.wikimedia.org/math/6/8/e/68e3159e23f04dedd681e91bc0fe40a2.png"> be an instance of TSP, i.e. <img class="mwe-math-fallback-image-inline tex" alt="G" src="//upload.wikimedia.org/math/d/f/c/dfcf28d0734569a6a693bc8194de62bf.png"> is a complete graph on the set <img class="mwe-math-fallback-image-inline tex" alt="V" src="//upload.wikimedia.org/math/5/2/0/5206560a306a2e085a437fd258eb57ce.png"> of vertices with weight function <img class="mwe-math-fallback-image-inline tex" alt="w" src="//upload.wikimedia.org/math/f/1/2/f1290186a5d0b1ceab27f4e77c0c5d68.png"> assigning a nonnegative real weight to every edge of <img class="mwe-math-fallback-image-inline tex" alt="G" src="//upload.wikimedia.org/math/d/f/c/dfcf28d0734569a6a693bc8194de62bf.png">.</p>
<p></p>
<h2>Contents</h2>
<ul>
<li>1 Algorithm</li>
<li>2 Approximation ratio</li>
<li>3 Example</li>
<li>4 References</li>
</ul>
<p></p>
<h2>Algorithm</h2>
<p>In pseudo-code:</p>
<ol>
<li>Create a minimum spanning tree <img class="mwe-math-fallback-image-inline tex" alt="T" src="//upload.wikimedia.org/math/b/9/e/b9ece18c950afbfa6b0fdbfa4ff731d3.png"> of <img class="mwe-math-fallback-image-inline tex" alt="G" src="//upload.wikimedia.org/math/d/f/c/dfcf28d0734569a6a693bc8194de62bf.png">.</li>
<li>Let <img class="mwe-math-fallback-image-inline tex" alt="O" src="//upload.wikimedia.org/math/f/1/8/f186217753c37b9b9f958d906208506e.png"> be the set of vertices with odd degree in <img class="mwe-math-fallback-image-inline tex" alt="T" src="//upload.wikimedia.org/math/b/9/e/b9ece18c950afbfa6b0fdbfa4ff731d3.png"> and find a perfect matching <img class="mwe-math-fallback-image-inline tex" alt="M" src="//upload.wikimedia.org/math/6/9/6/69691c7bdcc3ce6d5d8a1361f22d04ac.png"> with minimum weight in the complete graph over the vertices from <img class="mwe-math-fallback-image-inline tex" alt="O" src="//upload.wikimedia.org/math/f/1/8/f186217753c37b9b9f958d906208506e.png">.</li>
<li>Combine the edges of <img class="mwe-math-fallback-image-inline tex" alt="M" src="//upload.wikimedia.org/math/6/9/6/69691c7bdcc3ce6d5d8a1361f22d04ac.png"> and <img class="mwe-math-fallback-image-inline tex" alt="T" src="//upload.wikimedia.org/math/b/9/e/b9ece18c950afbfa6b0fdbfa4ff731d3.png"> to form a multigraph <img class="mwe-math-fallback-image-inline tex" alt="H" src="//upload.wikimedia.org/math/c/1/d/c1d9f50f86825a1a2302ec2449c17196.png">.</li>
<li>Form an Eulerian circuit in <img class="mwe-math-fallback-image-inline tex" alt="H" src="//upload.wikimedia.org/math/c/1/d/c1d9f50f86825a1a2302ec2449c17196.png"> (H is Eulerian because it is connected, with only even-degree vertices).</li>
<li>Make the circuit found in previous step Hamiltonian by skipping visited nodes (<i>shortcutting</i>).</li>
</ol>
<h2>Approximation ratio</h2>
<p>The cost of the solution produced by the algorithm is within 3/2 of the optimum.</p>
<p>The proof is as follows:</p>
<p>Let <var>A</var> denote the edge set of the optimal solution of TSP for <var>G</var>. Because <var>(V,A)</var> is connected, it contains some spanning tree <var>T</var> and thus <var>w(A)</var> ≥ <var>w(T)</var>. Further let <img class="mwe-math-fallback-image-inline tex" alt="B" src="//upload.wikimedia.org/math/9/d/5/9d5ed678fe57bcca610140957afab571.png"> denote the edge set of the optimal solution of TSP for the complete graph over vertices from <img class="mwe-math-fallback-image-inline tex" alt="O" src="//upload.wikimedia.org/math/f/1/8/f186217753c37b9b9f958d906208506e.png">. Because the edge weights are triangular (so visiting more nodes cannot reduce total cost), we know that <var>w(A)</var> ≥ <var>w(B)</var>. We show that there is a perfect matching of vertices from <img class="mwe-math-fallback-image-inline tex" alt="O" src="//upload.wikimedia.org/math/f/1/8/f186217753c37b9b9f958d906208506e.png"> with weight under <var>w(B)/2</var> ≤ <var>w(A)/2</var> and therefore we have the same upper bound for <img class="mwe-math-fallback-image-inline tex" alt="M" src="//upload.wikimedia.org/math/6/9/6/69691c7bdcc3ce6d5d8a1361f22d04ac.png"> (because <img class="mwe-math-fallback-image-inline tex" alt="M" src="//upload.wikimedia.org/math/6/9/6/69691c7bdcc3ce6d5d8a1361f22d04ac.png"> is a perfect matching of minimum cost). Because <img class="mwe-math-fallback-image-inline tex" alt="O" src="//upload.wikimedia.org/math/f/1/8/f186217753c37b9b9f958d906208506e.png"> must contain an even number of vertices, a perfect matching exists. Let <var>e</var><sub>1</sub>,...,<var>e</var><sub>2k</sub> be the (only) Eulerian path in <img class="mwe-math-fallback-image-inline tex" alt="(O,B)" src="//upload.wikimedia.org/math/8/b/4/8b4ba17d790bab8cc77d630d4fe595f2.png">. Clearly both <var>e</var><sub>1</sub>,<var>e</var><sub>3</sub>,...,<var>e</var><sub>2k-1</sub> and <var>e</var><sub>2</sub>,<var>e</var><sub>4</sub>,...,<var>e</var><sub>2k</sub> are perfect matchings and the weight of at least one of them is less than or equal to <var>w(B)/2</var>. Thus <var>w(M)+w(T)</var> ≤ <var>w(A) + w(A)/2</var> and from the triangle inequality it follows that the algorithm is 3/2-approximative.</p>
<h2>Example</h2>
<h1>Christofides algorithm</h1>
<p>The goal of the <b>Christofides approximation algorithm</b> (named after Nicos Christofides) is to find a solution to the instances of the traveling salesman problem where the edge weights satisfy the triangle inequality. Let <img class="mwe-math-fallback-image-inline tex" alt="G=(V,w)" src="//upload.wikimedia.org/math/6/8/e/68e3159e23f04dedd681e91bc0fe40a2.png"> be an instance of TSP, i.e. <img class="mwe-math-fallback-image-inline tex" alt="G" src="//upload.wikimedia.org/math/d/f/c/dfcf28d0734569a6a693bc8194de62bf.png"> is a complete graph on the set <img class="mwe-math-fallback-image-inline tex" alt="V" src="//upload.wikimedia.org/math/5/2/0/5206560a306a2e085a437fd258eb57ce.png"> of vertices with weight function <img class="mwe-math-fallback-image-inline tex" alt="w" src="//upload.wikimedia.org/math/f/1/2/f1290186a5d0b1ceab27f4e77c0c5d68.png"> assigning a nonnegative real weight to every edge of <img class="mwe-math-fallback-image-inline tex" alt="G" src="//upload.wikimedia.org/math/d/f/c/dfcf28d0734569a6a693bc8194de62bf.png">.</p>
<p></p>
<h2>Contents</h2>
<ul>
<li>1 Algorithm</li>
<li>2 Approximation ratio</li>
<li>3 Example</li>
<li>4 References</li>
</ul>
<p></p>
<h2>Algorithm</h2>
<p>In pseudo-code:</p>
<ol>
<li>Create a minimum spanning tree <img class="mwe-math-fallback-image-inline tex" alt="T" src="//upload.wikimedia.org/math/b/9/e/b9ece18c950afbfa6b0fdbfa4ff731d3.png"> of <img class="mwe-math-fallback-image-inline tex" alt="G" src="//upload.wikimedia.org/math/d/f/c/dfcf28d0734569a6a693bc8194de62bf.png">.</li>
<li>Let <img class="mwe-math-fallback-image-inline tex" alt="O" src="//upload.wikimedia.org/math/f/1/8/f186217753c37b9b9f958d906208506e.png"> be the set of vertices with odd degree in <img class="mwe-math-fallback-image-inline tex" alt="T" src="//upload.wikimedia.org/math/b/9/e/b9ece18c950afbfa6b0fdbfa4ff731d3.png"> and find a perfect matching <img class="mwe-math-fallback-image-inline tex" alt="M" src="//upload.wikimedia.org/math/6/9/6/69691c7bdcc3ce6d5d8a1361f22d04ac.png"> with minimum weight in the complete graph over the vertices from <img class="mwe-math-fallback-image-inline tex" alt="O" src="//upload.wikimedia.org/math/f/1/8/f186217753c37b9b9f958d906208506e.png">.</li>
<li>Combine the edges of <img class="mwe-math-fallback-image-inline tex" alt="M" src="//upload.wikimedia.org/math/6/9/6/69691c7bdcc3ce6d5d8a1361f22d04ac.png"> and <img class="mwe-math-fallback-image-inline tex" alt="T" src="//upload.wikimedia.org/math/b/9/e/b9ece18c950afbfa6b0fdbfa4ff731d3.png"> to form a multigraph <img class="mwe-math-fallback-image-inline tex" alt="H" src="//upload.wikimedia.org/math/c/1/d/c1d9f50f86825a1a2302ec2449c17196.png">.</li>
<li>Form an Eulerian circuit in <img class="mwe-math-fallback-image-inline tex" alt="H" src="//upload.wikimedia.org/math/c/1/d/c1d9f50f86825a1a2302ec2449c17196.png"> (H is Eulerian because it is connected, with only even-degree vertices).</li>
<li>Make the circuit found in previous step Hamiltonian by skipping visited nodes (<i>shortcutting</i>).</li>
</ol>
<h2>Approximation ratio</h2>
<p>The cost of the solution produced by the algorithm is within 3/2 of the optimum.</p>
<p>The proof is as follows:</p>
<p>Let <var>A</var> denote the edge set of the optimal solution of TSP for <var>G</var>. Because <var>(V,A)</var> is connected, it contains some spanning tree <var>T</var> and thus <var>w(A)</var> ≥ <var>w(T)</var>. Further let <img class="mwe-math-fallback-image-inline tex" alt="B" src="//upload.wikimedia.org/math/9/d/5/9d5ed678fe57bcca610140957afab571.png"> denote the edge set of the optimal solution of TSP for the complete graph over vertices from <img class="mwe-math-fallback-image-inline tex" alt="O" src="//upload.wikimedia.org/math/f/1/8/f186217753c37b9b9f958d906208506e.png">. Because the edge weights are triangular (so visiting more nodes cannot reduce total cost), we know that <var>w(A)</var> ≥ <var>w(B)</var>. We show that there is a perfect matching of vertices from <img class="mwe-math-fallback-image-inline tex" alt="O" src="//upload.wikimedia.org/math/f/1/8/f186217753c37b9b9f958d906208506e.png"> with weight under <var>w(B)/2</var> ≤ <var>w(A)/2</var> and therefore we have the same upper bound for <img class="mwe-math-fallback-image-inline tex" alt="M" src="//upload.wikimedia.org/math/6/9/6/69691c7bdcc3ce6d5d8a1361f22d04ac.png"> (because <img class="mwe-math-fallback-image-inline tex" alt="M" src="//upload.wikimedia.org/math/6/9/6/69691c7bdcc3ce6d5d8a1361f22d04ac.png"> is a perfect matching of minimum cost). Because <img class="mwe-math-fallback-image-inline tex" alt="O" src="//upload.wikimedia.org/math/f/1/8/f186217753c37b9b9f958d906208506e.png"> must contain an even number of vertices, a perfect matching exists. Let <var>e</var><sub>1</sub>,...,<var>e</var><sub>2k</sub> be the (only) Eulerian path in <img class="mwe-math-fallback-image-inline tex" alt="(O,B)" src="//upload.wikimedia.org/math/8/b/4/8b4ba17d790bab8cc77d630d4fe595f2.png">. Clearly both <var>e</var><sub>1</sub>,<var>e</var><sub>3</sub>,...,<var>e</var><sub>2k-1</sub> and <var>e</var><sub>2</sub>,<var>e</var><sub>4</sub>,...,<var>e</var><sub>2k</sub> are perfect matchings and the weight of at least one of them is less than or equal to <var>w(B)/2</var>. Thus <var>w(M)+w(T)</var> ≤ <var>w(A) + w(A)/2</var> and from the triangle inequality it follows that the algorithm is 3/2-approximative.</p>
<p>This tour is the algorithms output.</p>
</body>
</html>