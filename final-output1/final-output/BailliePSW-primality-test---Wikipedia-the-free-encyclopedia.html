<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>BailliePSW-primality-test---Wikipedia-the-free-encyclopedia.html</title></head>
<body>
<h1>Baillie–PSW primality test</h1>
<p>The <b>Baillie–PSW primality test</b> is a probabilistic primality testing algorithm that determines if a number is composite or a probable prime.</p>
<p>The Baillie-PSW test is a combination of a strong Fermat probable prime test to base 2 and a strong Lucas probable prime test. The Fermat and Lucas test each has its own list of pseudoprimes, that is, <i>composite</i> numbers that pass the primality test. For example, the first ten strong pseudoprimes to base 2 are 2047, 3277, 4033, 4681, 8321, 15841, 29341, 42799, 49141, and 52633 (sequence A001262 in OEIS). The first ten strong Lucas pseudoprimes (with Lucas parameters <i>D</i>, <i>P</i>, and <i>Q</i> chosen as described below) are 5459, 5777, 10877, 16109, 18971, 22499, 24569, 25199, 40309, and 58519 (sequence A217255 in OEIS).</p>
<p>The power of the Baillie-PSW test comes from the fact that these lists of strong Fermat pseudoprimes and strong Lucas pseudoprimes have <i>no known</i> overlap. There is even evidence that the numbers in these lists tend to be <i>different kinds</i> of numbers. For example, pseudoprimes base 2 tend to fall into the residue class 1 (mod <i>m</i>) for many small <i>m</i>, whereas Lucas pseudoprimes tend to fall into the residue class −1 (mod <i>m</i>); see Section 6 of  and Table 2 and Section 5 of . As a result, a number that passes both a strong Fermat and a strong Lucas test is very likely to be prime.</p>
<p>No composite number below 2 (approximately 1.845·10) passes the Baillie-PSW test. Consequently, this can be considered a deterministic primality test on numbers below that bound. There are also no <i>known</i> composite numbers above that bound that pass the test.</p>
<p>The authors of the test offered $30 for the discovery of a counterexample, that is, a composite number that passed this test. As of 1994, the value was raised to $620. As of June 2014 the prize remains unclaimed. However, a heuristic argument by Pomerance suggests that there are infinitely many counterexamples. Moreover, Chen and Greene   have constructed a set <i>S</i> of 1248 primes such that, among the nearly 2 products of distinct primes in <i>S</i>, there <i>may</i> be about 740 counterexamples.</p>
<p></p>
<h2>Contents</h2>
<ul>
<li>1 The test</li>
<li>2 The danger of relying only on Fermat tests</li>
<li>3 Applications of combined Fermat and Lucas primality tests</li>
<li>4 References</li>
<li>5 Further reading</li>
</ul>
<p></p>
<h2>The test</h2>
<p>Let <i>n</i> be the odd positive integer that we wish to test for primality.</p>
<ol>
<li>Optionally, perform trial division to check if <i>n</i> is divisible by a small prime number less than some convenient limit.</li>
<li>Perform a base 2 strong probable prime test. If <i>n</i> is not a strong probable prime base 2, then <i>n</i> is composite; quit.</li>
<li>Find the first <i>D</i> in the sequence 5, −7, 9, −11, ... for which the Jacobi symbol (<i>D</i>/<i>n</i>) is −1. Set <i>P</i> = 1 and <i>Q</i> = (1 − <i>D</i>) / 4.</li>
<li>Perform a strong Lucas probable prime test on <i>n</i> using parameters <i>D</i>, <i>P</i>, and <i>Q</i>. If <i>n</i> is not a strong Lucas probable prime, then <i>n</i> is composite. Otherwise, <i>n</i> is almost certainly prime.</li>
</ol>
<p>Remarks.</p>
<ol>
<li>The first step is for efficiency only. The Baillie-PSW test works without this step, but if <i>n</i> has small prime factors, then the quickest way to show that <i>n</i> is composite is to find a factor by trial division.</li>
<li>The second step is a single application of the Miller-Rabin primality test. There is nothing special about using base 2; other bases might work just as well. However, much work has been done (see above) to verify that the combination of the base 2 strong probable prime test and a strong Lucas test does a good job of distinguishing primes from composites.</li>
<li>If <i>n</i> is a perfect square, then step 3 will never yield a <i>D</i> with (<i>D</i>/<i>n</i>) = −1; this is not a problem because perfect squares are easy to detect using Newton's method for square roots. If step 3 fails to produce a <i>D</i> quickly, one should check whether <i>n</i> is a perfect square.</li>
<li>Given <i>n</i>, there are other methods for choosing <i>D</i>, <i>P</i>, and <i>Q</i>; see pages 1401 and 1409 of. What is important is that the Jacobi symbol (<i>D</i>/<i>n</i>) be −1. Bressoud and Wagon (, pp. 266–269) explain why we want the Jacobi symbol to be −1, as well as why one gets more powerful primality tests if <i>Q</i> ≠ ± 1.</li>
<li>If <i>Q</i> ≠ ±1, there are additional tests that can be performed at almost no extra computational cost. After one has computed the powers of <i>Q</i> and the terms in the Lucas sequences that are used in the strong Lucas probable prime test, these additional primality conditions provide further opportunities to show that <i>n</i> is composite; see Section 6 of.</li>
</ol>
<h2>The danger of relying only on Fermat tests</h2>
<p>There is significant overlap among the lists of pseudoprimes to different bases.</p>
<p>Choose a base <i>a</i>. If <i>n</i> is a pseudoprime to base <i>a</i>, then <i>n</i> is likely to be one of those few numbers that is a pseudoprime to many bases.</p>
<p>For example, <i>n</i> = 341 is a pseudoprime to base 2. It follows from Theorem 1 on page 1392 of  that there are 100 values of <i>a</i> (mod 341) for which 341 is a pseudoprime base <i>a</i>. (The first ten such <i>a</i> are 1, 2, 4, 8, 15, 16, 23, 27, 29, and 30). The proportion of such <i>a</i> compared to <i>n</i> is usually much smaller.</p>
<p>Therefore, if <i>n</i> is a pseudoprime to base <i>a</i>, then <i>n</i> is more likely than average to be a pseudoprime to some other base (see page 1020 of ). For example, there are 21853 pseudoprimes to base 2 up to 25·10. This is only about two out of every million odd integers in this range. However (see page 1021 of ):</p>
<ul>
<li>4709 of these 21853 numbers (over 21 percent) are also pseudoprimes to base 3;</li>
<li>2522 of <i>these</i> 4709 numbers (over 53 percent) are pseudoprimes to bases 2, 3, and 5;</li>
<li>1770 of <i>these</i> 2522 numbers (over 70 percent) are pseudoprimes to bases 2, 3, 5, and 7.</li>
</ul>
<p>29341 is the smallest pseudoprime to bases 2, 3, 5, and 7. This suggests that probable prime tests to different bases are not independent of each other, so that performing Fermat probable prime tests to more and more bases will give diminishing returns. On the other hand, the calculations up to 2, mentioned above, suggest that Fermat and Lucas probable prime tests <i>are</i> independent (see also page 1400 of ), so that a <i>combination</i> of these types of tests would make a powerful primality test, especially if the <i>strong</i> forms of the tests are used.</p>
<p>There is also overlap among <i>strong</i> pseudoprimes to different bases. For example, 1373653 is the smallest strong pseudoprime to bases 2 and 3, and 3215031751 is the smallest strong pseudoprime to bases 2, 3, 5, and 7. Arnault  gives a 397-digit composite number <i>N</i> that is a <i>strong</i> pseudoprime to <i>all</i> bases less than 307. Because this <i>N</i> is a Carmichael number, <i>N</i> is also a (not necessarily strong) pseudoprime to all bases less than <i>p</i>, where <i>p</i> is the 131-digit smallest prime factor of <i>N</i>. A quick calculation shows that <i>N</i> is <i>not</i> a Lucas probable prime when <i>D</i>, <i>P</i>, and <i>Q</i> are chosen by the method described above, so this number would be correctly determined by the Baillie-PSW test to be composite.</p>
<h2>Applications of combined Fermat and Lucas primality tests</h2>
<p>The following computer algebra systems and software packages use some version of the Baillie–PSW primality test.</p>
<p>Maple's <b>isprime</b> function , Mathematica's <b>PrimeQ</b> function , PARI/GP's <b>isprime</b> and <b>ispseudoprime</b> functions , and Sage's <b>is_pseudoprime</b> function  all use a combination of a Miller-Rabin (Fermat strong probable prime) test and a Lucas test. Maxima's <b>primep</b> function uses such a test for numbers greater than 341550071728321 .</p>
<p>The FLINT library has functions <b>n_is_probabprime</b> and <b>n_is_probabprime_BPSW</b> that use a combined test, as well as other functions that perform Fermat and Lucas tests separately .</p>
<p>The <b>BigInteger</b> class in standard versions of Java and in open-source implementations like OpenJDK, has a method called <b>isProbablePrime</b>. This method does one or more Miller-Rabin tests with random bases. If <i>n</i>, the number being tested, has 100 bits or more, this method also does a <i>non-strong</i> Lucas test that checks whether <i>U<sub>n+1</sub></i> is 0 (mod <i>n</i>).   The use of random bases in the Miller-Rabin tests has an advantage and a drawback compared to doing a single base 2 test as specified in the Baillie–PSW test. The advantage is that, with random bases, one can get a bound on the probability that <i>n</i> is composite. The drawback is that, unlike the Baillie–PSW test, one cannot say with certainty that if <i>n</i> is less than some fixed bound such as 2, then <i>n</i> is prime.</p>
<p>In Perl, the <b>Math::Primality</b> and <b>Math::Prime::Util</b> modules have functions to perform the strong Baillie-PSW test as well as separate functions for strong pseudoprime and strong Lucas tests. In Python, the <b>NZMATH</b> library has the strong pseudoprime and Lucas tests, but does not have a combined function.</p>
<p>GNU Multiple Precision Arithmetic Library's <b>mpz_probab_prime_p</b> function uses a Miller-Rabin test, but does <i>not</i> appear to use a Lucas test . Magma's <b>IsProbablePrime</b> and <b>IsProbablyPrime</b> functions use 20 Miller-Rabin tests for numbers &gt; 34·10, but do not combine them with a Lucas probable prime test .</p>
</body>
</html>